rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ğŸ”’ DEFAULT DENY
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Aktifkan blok di bawah ini nanti
       supaya semua akses ditolak
       kecuali yang diizinkan eksplisit.
    ----------------------------------------------------------------
    match /{document=**} {
      allow read, write: if false;
    }
    ----------------------------------------------------------------*/

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ğŸ“ 1. app_settings (root)
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    match /app_settings/{settingId} {
      allow read : if true ;                // publik baca
      allow write: if true ;                // â›” ubah ke aturan admin
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ğŸ“ 2. schedules (root)
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    match /schedules_tanding/{scheduleId} {
      allow read , write: if true ;         // â›” ubah ke aturan admin
    }
    match /schedules_tgr/{scheduleId} {
      allow read , write: if true ;         // â›” ubah ke aturan admin
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ğŸ“ 3. matches_tanding (root â†’ subkoleksi)
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    match /matches_tanding/{matchId} {

      /* Dokumen matchId itu sendiri */
      allow read , write: if true ;         // â›” kunci di produksi

      /* Subkoleksi juri_scores    â†’ matches_tanding/{matchId}/juri_scores/{juriId} */
      match /juri_scores/{juriId} {
        allow read , write: if true ;       // â›” batasi ke juri terkait
      }

      /* Subkoleksi official_actions â†’ matches_tanding/{matchId}/official_actions/{actionId} */
      match /official_actions/{actionId} {
        allow read , write: if true ;       // â›” batasi ke ketua
      }

      /* Subkoleksi verifications   â†’ matches_tanding/{matchId}/verifications/{verificationId} */
      match /verifications/{verificationId} {
        allow read , write: if true ;       // â›” batasi sesuai peran
      }
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ğŸ“ 4. matches_tgr (root â†’ subkoleksi)
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    match /matches_tgr/{matchId} {

      allow read , write: if true ;         // â›” kunci di produksi

      match /juri_scores/{juriId} {
        allow read , write: if true ;       // â›” batasi ke juri terkait
      }
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ğŸ“ 5. users (opsional contoh)
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    match /users/{userId} {
      allow read : if request.auth != null;                 // hanya user login
      allow write: if request.auth != null
                    && request.auth.uid == userId;          // hanya diri sendiri
    } */
  }
}
